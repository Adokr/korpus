---
title: "ChiKwadrat i Wilcoxon"
output:
  html_document: default
  pdf_document: default
---

```{r}
library(knitr)
data <- read.csv("py/FINAL_18_03.csv")
govOnTheLeft <- data[data[1] == "L",]
govOnTheRight <- data[data[1] == "R",]
govNo <- data[data[1] == "0",]

x = c(nrow(govOnTheLeft), 100 * nrow(govOnTheLeft)/nrow(data))
y = c(nrow(govOnTheRight), 100* nrow(govOnTheRight)/nrow(data))
z = c(nrow(govNo), 100* nrow(govNo)/nrow(data))
govPosition <- data.frame(Nadrzędnik_z_lewej = x, 
                          Nadrzędnik_z_prawej = y,
                          Brak_nadrzędnika = z)

rownames(govPosition) <- c('Liczba', 'Procent')
kable(govPosition, digits=1)

govOnTheLeft[1,23] #znaki to 14 oraz 23

funkcja1 <- function(data){
  dlZnaki <- c(data[,14], data[,23])
  dlSylaby <- c(data[,13], data[,22])
  dlSlowa <- c(data[,12], data[,21])
  dlTokeny <- c(data[,11], data[, 20])
  człon = c(rep('PierwszyCzłon', nrow(data)), rep("DrugiCzłon", nrow(data)))
  x <- c(median(data[, 14]), median(data[,13]), median(data[, 12]), median(data[, 11]))
  y <- c(median(data[, 23]), median(data[, 22]), median(data[, 21]), median(data[, 20]))
  z <- c(mean(data[, 14]), mean(data[,13]), mean(data[, 12]), mean(data[, 11]))
  w <- c(mean(data[, 23]), mean(data[, 22]), mean(data[, 21]), mean(data[, 20]))
  a <- c(as.double(wilcox.test(dlZnaki ~ człon, data = data, alternative = "greater")[1]), 
         as.double(wilcox.test(dlSylaby ~ człon, data = data, alternative= "greater")[1]),
         as.double(wilcox.test(dlSlowa ~ człon, data = data, alternative = "greater")[1]),
         as.double(wilcox.test(dlTokeny ~ człon, data = data, alternative = "greater")[1]))
  
  b <- c(as.double(wilcox.test(dlZnaki ~ człon, data = data, alternative = "greater")[3]), 
         as.double(wilcox.test(dlSylaby ~ człon, data = data, alternative = "greater")[3]),
         as.double(wilcox.test(dlSlowa ~ człon, data = data, alternative = "greater")[3]),
         as.double(wilcox.test(dlTokeny ~ człon, data = data, alternative = "greater")[3]))
  wyn <- data.frame(median_L = x, median_R = y, mean_L = z, mean_R = w, V = a, p = b)
  rownames(wyn) <- c('znaki', 'sylaby', 'słowa', 'tokeny')
  return (wyn)
}

x <- nrow(govOnTheLeft[govOnTheLeft[14] != govOnTheLeft[23],])
x
funkcja2 <- function(data){
  govOnTheLeft <- data[data[1] == "L",]
  govOnTheRight <- data[data[1] == "R",]
  govNo <- data[data[1] == "0",]
  człon = c(rep('PierwszyCzłon', nrow(data)), rep("DrugiCzłon", nrow(data)))
  x <- c(nrow(govOnTheLeft[govOnTheLeft[14] < govOnTheLeft[23],])/nrow(govOnTheLeft[govOnTheLeft[14] != govOnTheLeft[23],]),
         nrow(govOnTheLeft[govOnTheLeft[13] < govOnTheLeft[22],])/nrow(govOnTheLeft[govOnTheLeft[13] != govOnTheLeft[22],]),
         nrow(govOnTheLeft[govOnTheLeft[12] < govOnTheLeft[21],])/nrow(govOnTheLeft[govOnTheLeft[12] != govOnTheLeft[21],]),
         nrow(govOnTheLeft[govOnTheLeft[11] < govOnTheLeft[20],])/nrow(govOnTheLeft[govOnTheLeft[11] != govOnTheLeft[20],]))
  y <- c(nrow(govOnTheLeft[govOnTheLeft[14] != govOnTheLeft[23],]), 
         nrow(govOnTheLeft[govOnTheLeft[13] != govOnTheLeft[22],]),
         nrow(govOnTheLeft[govOnTheLeft[12] != govOnTheLeft[21],]),
         nrow(govOnTheLeft[govOnTheLeft[11] != govOnTheLeft[20],]))
  z <- c(nrow(govOnTheRight[govOnTheRight[14] < govOnTheRight[23],])/nrow(govOnTheRight[govOnTheRight[14] != govOnTheRight[23],]),
         nrow(govOnTheRight[govOnTheRight[13] < govOnTheRight[22],])/nrow(govOnTheRight[govOnTheRight[13] != govOnTheRight[22],]),
         nrow(govOnTheRight[govOnTheRight[12] < govOnTheRight[21],])/nrow(govOnTheRight[govOnTheRight[12] != govOnTheRight[21],]),
         nrow(govOnTheRight[govOnTheRight[11] < govOnTheRight[20],])/nrow(govOnTheRight[govOnTheRight[11] != govOnTheRight[20],]))
  w <- c(nrow(govOnTheRight[govOnTheRight[14] != govOnTheRight[23],]),
         nrow(govOnTheRight[govOnTheRight[13] != govOnTheRight[22],]),
         nrow(govOnTheRight[govOnTheRight[12] != govOnTheRight[21],]),
         nrow(govOnTheRight[govOnTheRight[11] != govOnTheRight[20],]))
  
  M1 <- as.table( rbind(c(x[1]*y[1], (1-x[1])*y[1]), c(z[1]*w[1], (1-z[1])*w[1]) ))
  chi_char <- chisq.test(M1)
  
  M2 <- as.table( rbind(c(x[2]*y[2], (1-x[2])*y[2]), c(z[2]*w[2], (1-z[2])*w[2]) ))
  chi_syl <- chisq.test(M2)
  
  M3<- as.table( rbind(c(x[3]*y[3], (1-x[3])*y[3]), c(z[3]*w[3], (1-z[3])*w[3]) ))
  chi_words <- chisq.test(M3)
  
  M4 <- as.table( rbind(c(x[4]*y[4], (1-x[4])*y[4]), c(z[4]*w[4], (1-z[4])*w[4]) ))
  chi_tokens <- chisq.test(M4)
  
  a <- c(chi_char$statistic, chi_syl$statistic, chi_words$statistic, chi_tokens$statistic)
  
  b <- c(chi_char$p.value, chi_syl$p.value, chi_words$p.value, chi_tokens$p.value)
  wyn <- data.frame(gov_on_L_prop = x, gov_on_L_N  = y, gov_on_R_prop = z, gov_on_R_N = w, chi_sqr = a, p = b)
  
  rownames(wyn) <- c('znaki', 'sylaby', 'słowa', 'tokeny')
  
  return (wyn)
}

funkcja3 <- function(data){
  govOnTheLeft <- data[data[1] == "L",]
  govOnTheRight <- data[data[1] == "R",]
  govNo <- data[data[1] == "0",]
  człon = c(rep('PierwszyCzłon', nrow(data)), rep("DrugiCzłon", nrow(data)))
  m <- c(nrow(govNo[govNo[14] < govNo[23],])/nrow(govNo[govNo[14] != govNo[23],]),
         nrow(govNo[govNo[13] < govNo[22],])/nrow(govNo[govNo[13] != govNo[22],]),
         nrow(govNo[govNo[12] < govNo[21],])/nrow(govNo[govNo[12] != govNo[21],]),
         nrow(govNo[govNo[11] < govNo[20],])/nrow(govNo[govNo[11] != govNo[20],]))
  n <- c(nrow(govNo[govNo[14] != govNo[23],]), 
         nrow(govNo[govNo[13] != govNo[22],]),
         nrow(govNo[govNo[12] != govNo[21],]),
         nrow(govNo[govNo[11] != govNo[20],]))
  x <- c(nrow(govOnTheLeft[govOnTheLeft[14] < govOnTheLeft[23],])/nrow(govOnTheLeft[govOnTheLeft[14] != govOnTheLeft[23],]),
         nrow(govOnTheLeft[govOnTheLeft[13] < govOnTheLeft[22],])/nrow(govOnTheLeft[govOnTheLeft[13] != govOnTheLeft[22],]),
         nrow(govOnTheLeft[govOnTheLeft[12] < govOnTheLeft[21],])/nrow(govOnTheLeft[govOnTheLeft[12] != govOnTheLeft[21],]),
         nrow(govOnTheLeft[govOnTheLeft[11] < govOnTheLeft[20],])/nrow(govOnTheLeft[govOnTheLeft[11] != govOnTheLeft[20],]))
  y <- c(nrow(govOnTheLeft[govOnTheLeft[14] != govOnTheLeft[23],]), 
         nrow(govOnTheLeft[govOnTheLeft[13] != govOnTheLeft[22],]),
         nrow(govOnTheLeft[govOnTheLeft[12] != govOnTheLeft[21],]),
         nrow(govOnTheLeft[govOnTheLeft[11] != govOnTheLeft[20],]))
  z <- c(nrow(govOnTheRight[govOnTheRight[14] < govOnTheRight[23],])/nrow(govOnTheRight[govOnTheRight[14] != govOnTheRight[23],]),
         nrow(govOnTheRight[govOnTheRight[13] < govOnTheRight[22],])/nrow(govOnTheRight[govOnTheRight[13] != govOnTheRight[22],]),
         nrow(govOnTheRight[govOnTheRight[12] < govOnTheRight[21],])/nrow(govOnTheRight[govOnTheRight[12] != govOnTheRight[21],]),
         nrow(govOnTheRight[govOnTheRight[11] < govOnTheRight[20],])/nrow(govOnTheRight[govOnTheRight[11] != govOnTheRight[20],]))
  w <- c(nrow(govOnTheRight[govOnTheRight[14] != govOnTheRight[23],]),
         nrow(govOnTheRight[govOnTheRight[13] != govOnTheRight[22],]),
         nrow(govOnTheRight[govOnTheRight[12] != govOnTheRight[21],]),
         nrow(govOnTheRight[govOnTheRight[11] != govOnTheRight[20],]))
  
  M1 <- as.table( rbind(c(m[1]*n[1], (1-m[1])*n[1]), c(x[1]*y[1], (1-x[1])*y[1]) ))
  chi_char_L <- chisq.test(M1)
  M2 <- as.table( rbind(c(m[2]*n[2], (1-m[2])*n[2]), c(x[2]*y[2], (1-x[2])*y[2]) ))
  chi_syl_L <- chisq.test(M2)
  M3 <- as.table( rbind(c(m[3]*n[3], (1-m[3])*n[3]), c(x[3]*y[3], (1-x[3])*y[3]) ))
  chi_words_L <- chisq.test(M3)
  M4 <- as.table( rbind(c(m[4]*n[4], (1-m[4])*n[4]), c(x[4]*y[4], (1-x[4])*y[4]) ))
  chi_tokens_L <- chisq.test(M4)
  
  statL <-c(chi_char_L$statistic, chi_syl_L$statistic, chi_words_L$statistic, chi_tokens_L$statistic)
  pvalL <-c(chi_char_L$p.value, chi_syl_L$p.value, chi_words_L$p.value, chi_tokens_L$p.value)
  
  M5 <- as.table( rbind(c(m[1]*n[1], (1-m[1])*n[1]), c(z[1]*w[1], (1-z[1])*w[1]) ))
  chi_char_R <- chisq.test(M5)
  M6 <- as.table( rbind(c(m[2]*n[2], (1-m[2])*n[2]), c(z[2]*w[2], (1-z[2])*w[2]) ))
  chi_syl_R <- chisq.test(M6)
  M7 <- as.table( rbind(c(m[3]*n[3], (1-m[3])*n[3]), c(z[3]*w[3], (1-z[3])*w[3]) ))
  chi_words_R <- chisq.test(M7)
  M8 <- as.table( rbind(c(m[4]*n[4], (1-m[4])*n[4]), c(z[4]*w[4], (1-z[4])*w[4]) ))
  chi_tokens_R <- chisq.test(M8)
  
  statR <-c(chi_char_R$statistic, chi_syl_R$statistic, chi_words_R$statistic, chi_tokens_R$statistic)
  pvalR <-c(chi_char_R$p.value, chi_syl_R$p.value, chi_words_R$p.value, chi_tokens_R$p.value)

  wyn <- data.frame(no_gov_prop = m, no_gov_N = n, chi_sqr_L = statL, p_L = pvalL, chi_sqr_R = statR, p_R=pvalR)
  rownames(wyn) <- c('znaki', 'sylaby', 'słowa', 'tokeny')
  
  return(wyn)
}

kable(funkcja1(data), digits=2, caption = "Wszystkie koordynacje")
kable(funkcja1(govNo), digits=2, caption = "Brak nadrzędnika")
kable(funkcja1(govOnTheLeft), digits=2, caption = "Nadrzędnik z lewej")
kable(funkcja1(govOnTheRight), digits=2, caption = "Nadrzędnik z prawej")

kable(funkcja2(data), caption= "Procent krótszych członów po lewej (lub prawej) stronie od nadrzędnika wśród różnolicznych członów")

kable(funkcja3(data), caption= "Procent krótszych członów po lewej (lub prawej) stronie od nadrzędnika wśród różnolicznych członów")

```
