---
title: "Statystyki do pracy licencjackiej"
author: "Adam Okrasiński"
date: "3/14/2023"
output: html_document
---

```{r}
library(tidyverse)
library(ggplot2)
library(gridExtra)
data <- read.csv("py/FINAL_18_03.csv")

data <- data %>% summarize(position=Pozycja.Nadrzędnika, 
                          chars1=Znaki.Pierwszego.Członu, 
                          syllables1=Sylaby.Pierwszego.Członu, 
                          words1=Słowa.Pierwszego.Członu, 
                          tokens1=Tokeny.Pierwszego.Członu, 
                          chars2=Znaki.Drugiego.Członu, 
                          syllables2=Sylaby.Drugiego.Członu, 
                          words2=Słowa.Drugiego.Członu, 
                          tokens2=Tokeny.Drugiego.Członu)

dataLeftGov <- data[data$position == "L",]
dataRightGov <- data[data$position == "R",]
dataNoGov <- data[data$position == "0",]

#perOfShorLef: jeśli krótszy człon po lewej to 1; jeśli po prawej to 0

funkcja1 <- function(data){
  dataWithDiff <- data %>% summarize(position, 
                                    charsDiff = chars1 - chars2, 
                                    syllablesDiff = syllables1 - syllables2,
                                    wordsDiff = words1 - words2, 
                                    tokensDiff = tokens1 - tokens2)
  
  dataChars <- dataWithDiff %>% filter(charsDiff != 0)
  dataSyllables <- dataWithDiff %>% filter(syllablesDiff != 0)
  dataWords <- dataWithDiff %>% filter(wordsDiff != 0)
  dataTokens <- dataWithDiff %>% filter(tokensDiff != 0)
  
  dataChars <- dataChars %>% mutate(absCharsDiff = abs(charsDiff)) %>% 
                      group_by(absCharsDiff) %>%     
                      summarize(shorterLeft = ifelse(charsDiff < 0, 1, 0), absCharsDiff)
  
  dataSyllables <- dataSyllables %>% mutate(absSyllablesDiff = abs(syllablesDiff)) %>% 
          group_by(absSyllablesDiff) %>%     
          summarize(shorterLeft = ifelse(syllablesDiff < 0, 1, 0), absSyllablesDiff)
  
  dataWords <- dataWords %>% mutate(absWordsDiff = abs(wordsDiff)) %>% 
                      group_by(absWordsDiff) %>%     
                      summarize(shorterLeft = ifelse(wordsDiff < 0, 1, 0), absWordsDiff)
  
  dataTokens <- dataTokens %>% mutate(absTokensDiff = abs(tokensDiff)) %>% 
                  group_by(absTokensDiff) %>%     
                  summarize(shorterLeft = ifelse(tokensDiff < 0, 1, 0), absTokensDiff)

  return(list(dataChars, dataSyllables, dataWords, dataTokens))
}

Left <- funkcja1(dataLeftGov)
Right <- funkcja1(dataRightGov)
No <- funkcja1(dataNoGov)

x1 <- do.call(rbind.data.frame, Left[1])
x2 <- do.call(rbind.data.frame, Left[2])
x3 <- do.call(rbind.data.frame, Left[3])
x4 <- do.call(rbind.data.frame, Left[4])
x5 <- do.call(rbind.data.frame, Right[1])
x6 <- do.call(rbind.data.frame, Right[2])
x7 <- do.call(rbind.data.frame, Right[3])
x8 <- do.call(rbind.data.frame, Right[4])
x9 <- do.call(rbind.data.frame, No[1])
x10 <- do.call(rbind.data.frame, No[2])
x11 <- do.call(rbind.data.frame, No[3])
x12 <- do.call(rbind.data.frame, No[4])
 
#glm

L1 <- ggplot(x1, aes(absCharsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in characters") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
L2 <- ggplot(x2, aes(absSyllablesDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in syllables") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
L3 <- ggplot(x3, aes(absWordsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in words") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
L4 <- ggplot(x4, aes(absTokensDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in tokens") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
R1 <- ggplot(x5, aes(absCharsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in characters") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.1, 1))
R2 <- ggplot(x6, aes(absSyllablesDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in syllables") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.1, 1))
R3 <- ggplot(x7, aes(absWordsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in words") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.1, 1))
R4 <- ggplot(x8, aes(absTokensDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in tokens") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.1, 1))
N1 <- ggplot(x9, aes(absCharsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in characters") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
N2 <- ggplot(x10, aes(absSyllablesDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in syllables") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
N3 <- ggplot(x11, aes(absWordsDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in words") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))
N4 <- ggplot(x12, aes(absTokensDiff, shorterLeft)) +
        geom_smooth(method="glm", formula = y ~ x, method.args = list(family = binomial))+
        labs(x = "absolute difference in tokens") +
        labs(y = "proportion of shorter left conjuncts")+
        coord_cartesian(ylim=c(0.4, 1))

ggpubr::ggarrange(N1, N2, N3, N4, L1, L2, L3, L4, R1, R2, R3, R4, ncol=4, nrow=3)
```
